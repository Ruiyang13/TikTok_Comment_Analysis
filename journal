Getting the data:
It is tough since TikTok has strict restrictions on scraping data and I do not want my account to be locked. Extensions are expensive, probabily against platform guidelines and privacy is also a concern. 
Therefore I used the dumbest way: to copy paste the comments myself. Not literally just selecting all the comments and scroll down, but still quite tedious. So I went to the console of each video and entered the following request:
(function() {
    // --- PART 1: Video Context ---
    let url = window.location.href;
    let videoId = url.split('video/')[1]?.split('?')[0] || "Unknown ID";
    
    let rawCaption = document.querySelector('[data-e2e="video-desc"]')?.innerText.replace(/[\n\r\t]+/g, " ") || "";
    
    // Extract Hashtags specifically using a Regex pattern
    let hashtags = rawCaption.match(/#[^\s#]+/g)?.join(', ') || "No Hashtags";
    
    let vidLikes = document.querySelector('[data-e2e="like-count"]')?.innerText || "0";
    let vidShares = document.querySelector('[data-e2e="share-count"]')?.innerText || "0";

    // --- PART 2: Deep Comment Mining ---
    let commentItems = document.querySelectorAll('div[class*="DivCommentItemWrapper"]');

    if (commentItems.length === 0) {
        alert("No comments found! Scroll down first.");
        return;
    }

    let outputData = "";

    commentItems.forEach(item => {
        // Basic Info
        let username = item.querySelector('[data-e2e="comment-username-1"]')?.innerText.replace(/[\n\r\t]+/g, " ") || "Unknown";
        let text = item.querySelector('[data-e2e="comment-level-1"]')?.innerText.replace(/[\n\r\t]+/g, " ") || "";
        let likes = item.querySelector('div[class*="DivLikeContainer"] span')?.innerText || "0";
        let time = item.querySelector('div[class*="DivCommentSubContentWrapper"] span')?.innerText || "Unknown";

        // Advanced: Check for Reply Count
        // TikTok usually hides this under "View X replies". We try to find that button.
        let replyBtn = item.querySelector('[data-e2e="comment-reply-count"]'); 
        let replyCount = "0";
        if (replyBtn) {
            // Extracts just the number from "View 5 replies"
            replyCount = replyBtn.innerText.match(/\d+/)?.[0] || "0";
        }

        // Add to the row (Separated by Tabs)
        outputData += `${videoId}\t${url}\t${rawCaption}\t${hashtags}\t${vidLikes}\t${vidShares}\t${username}\t${text}\t${likes}\t${replyCount}\t${time}\n`;
    });

    // --- PART 3: Export ---
    let dummy = document.createElement("textarea");
    document.body.appendChild(dummy);
    dummy.value = outputData;
    dummy.select();
    document.execCommand("copy");
    document.body.removeChild(dummy);

    alert(`Extracted ${commentItems.length} comments with Deep Insights!\n\nNew Data:\n- Hashtags separated\n- Reply Counts extracted\n\nPaste into Excel now.`);
})();

